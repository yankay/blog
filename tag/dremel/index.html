<!DOCTYPE html>
<!--[if lt IE 7]>
<html class="ie ie6 lte9 lte8 lte7" lang="zh-CN">
<![endif]--><!--[if IE 7]>
<html class="ie ie7 lte9 lte8 lte7" lang="zh-CN">
<![endif]--><!--[if IE 8]>
<html class="ie ie8 lte9 lte8" lang="zh-CN">
<![endif]--><!--[if IE 9]>
<html class="ie ie9" lang="zh-CN">
<![endif]--><!--[if gt IE 9]>
<html lang="zh-CN"> <![endif]--><!--[if !IE]><!--><html lang="zh-CN">
<!--<![endif]-->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="initial-scale=1.0,maximum-scale=3.0,width=device-width">

	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="./../../xmlrpc.php">

	<!-- IE6-8 support of HTML5 elements -->
	<!--[if lt IE 9]>
	<script src="http://yankay.com/wp-content/themes/neuro/inc/js/html5.js" type="text/javascript"></script>
	<![endif]-->

	<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

	<!-- This site is optimized with the Yoast SEO plugin v16.4 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Dremel归档 - 我自然</title>
	<link rel="canonical" href="./index.html">
	<meta property="og:locale" content="zh_CN">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Dremel归档 - 我自然">
	<meta property="og:url" content="./index.html">
	<meta property="og:site_name" content="我自然">
	<meta name="twitter:card" content="summary_large_image">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":".//#website","url":".//","name":"我自然","description":"颜开的博客","potentialAction":[{"@type":"SearchAction","target":".//?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"zh-CN"},{"@type":"CollectionPage","@id":".//tag/dremel/#webpage","url":".//tag/dremel/","name":"Dremel归档 - 我自然","isPartOf":{"@id":".//#website"},"breadcrumb":{"@id":".//tag/dremel/#breadcrumb"},"inLanguage":"zh-CN","potentialAction":[{"@type":"ReadAction","target":[".//tag/dremel/"]}]},{"@type":"BreadcrumbList","@id":".//tag/dremel/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":".//","url":".//","name":"首页"}},{"@type":"ListItem","position":2,"item":{"@id":".//tag/dremel/#webpage"}}]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="alternate" type="application/rss+xml" title="我自然 &raquo; Feed" href="./../../feed/index.html">
<link rel="alternate" type="application/rss+xml" title="我自然 &raquo; 评论Feed" href="./../../comments/feed/index.html">
			<link rel="shortcut icon" href="http://47.100.65.109/wp-content/uploads/2021/03/favicon.png" type="image/x-icon">
		<link rel="alternate" type="application/rss+xml" title="我自然 &raquo; Dremel标签Feed" href="./feed/index.html">
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":".\/\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.4.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"🏳️‍⚧️","🏳️​⚧️")?!1:!n(e,"🇺🇳","🇺​🇳")&&!n(e,"🏴󠁧󠁢󠁥󠁮󠁧󠁿","🏴​󠁧​󠁢​󠁥​󠁮​󠁧​󠁿");case"emoji":return!n(e,"🫱🏻‍🫲🏿","🫱🏻​🫲🏿")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id="wp-emoji-styles-inline-css" type="text/css">img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}</style>
<link rel="stylesheet" id="wp-block-library-css" href="./../../wp-includes/css/dist/block-library/style.min.css?ver=6.4.2" type="text/css" media="all">
<style id="classic-theme-styles-inline-css" type="text/css">/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}</style>
<style id="global-styles-inline-css" type="text/css">body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--gray: #777;--wp--preset--color--light-gray: #f5f5f5;--wp--preset--color--blue: #0286cf;--wp--preset--color--legacy: #b6b6b6;--wp--preset--color--red: #c80a00;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}</style>
<link rel="stylesheet" id="bootstrap-style-css" href="./../../wp-content/themes/neuro/cyberchimps/lib/bootstrap/css/bootstrap.min.css?ver=2.0.4" type="text/css" media="all">
<link rel="stylesheet" id="bootstrap-responsive-style-css" href="./../../wp-content/themes/neuro/cyberchimps/lib/bootstrap/css/bootstrap-responsive.min.css?ver=2.0.4" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-css" href="./../../wp-content/themes/neuro/cyberchimps/lib/css/font-awesome.min.css?ver=6.4.2" type="text/css" media="all">
<link rel="stylesheet" id="cyberchimps_responsive-css" href="./../../wp-content/themes/neuro/cyberchimps/lib/bootstrap/css/cyberchimps-responsive.min.css?ver=1.0" type="text/css" media="all">
<link rel="stylesheet" id="core-style-css" href="./../../wp-content/themes/neuro/cyberchimps/lib/css/core.css?ver=1.0" type="text/css" media="all">
<link rel="stylesheet" id="style-css" href="./../../wp-content/themes/neuro/style.css?ver=1.0" type="text/css" media="all">
<link rel="stylesheet" id="elements_style-css" href="./../../wp-content/themes/neuro/elements/lib/css/elements.css?ver=6.4.2" type="text/css" media="all">
        <script>
            /* <![CDATA[ */
            var rcewpp = {
                "ajax_url":"http://yankay.com/wp-admin/admin-ajax.php",
                "nonce": "aa462ebe7f",
                "home_url": "http://yankay.com/",
                "settings_icon": 'http://yankay.com/wp-content/plugins/export-wp-page-to-static-html/admin/images/settings.png',
                "settings_hover_icon": 'http://yankay.com/wp-content/plugins/export-wp-page-to-static-html/admin/images/settings_hover.png'
            };
            /* ]]\> */
        </script>
        <script type="text/javascript" src="./../../wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="./../../wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" src="./../../wp-content/themes/neuro/cyberchimps/lib/js/jquery.slimbox.min.js?ver=1.0" id="slimbox-js"></script>
<script type="text/javascript" src="./../../wp-content/themes/neuro/cyberchimps/lib/js/jquery.jcarousel.min.js?ver=1.0" id="jcarousel-js"></script>
<script type="text/javascript" src="./../../wp-content/themes/neuro/cyberchimps/lib/js/jquery.mobile.custom.min.js?ver=6.4.2" id="jquery-mobile-touch-js"></script>
<script type="text/javascript" src="./../../wp-content/themes/neuro/cyberchimps/lib/js/swipe-call.min.js?ver=6.4.2" id="slider-call-js"></script>
<script type="text/javascript" src="./../../wp-content/themes/neuro/cyberchimps/lib/js/core.min.js?ver=6.4.2" id="core-js-js"></script>
<script type="text/javascript" src="./../../wp-content/themes/neuro/elements/lib/js/elements.min.js?ver=6.4.2" id="elements_js-js"></script>
<link rel="https://api.w.org/" href="./../../wp-json/index.html">
<link rel="alternate" type="application/json" href="./../../wp-json/wp/v2/tags/23/index.html">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="./../../xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.4.2">
<style type="text/css">.ie8 .container {max-width: 1020px;width:auto;}</style>
<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
	<style type="text/css" media="all">body {
		 font-size : 16px;
		 font-family : "Open Sans", Helvetica, Arial, "Lucida Grande", sans-serif;
		 font-weight : normal;
		 color : #333333;
				}

										.container {
		 max-width : 1020px;
				}

		
				h1, h2, h3, h4, h5, h6 {
		font-family : Arial, Helvetica, sans-serif;
				}</style>
	<link rel="icon" href="./../../wp-content/uploads/2021/03/cropped-favicon-32x32.png" sizes="32x32">
<link rel="icon" href="./../../wp-content/uploads/2021/03/cropped-favicon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="./../../wp-content/uploads/2021/03/cropped-favicon-180x180.png">
<meta name="msapplication-TileImage" content="./../../wp-content/uploads/2021/03/cropped-favicon-270x270.png">
	
	<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-10148377-3"></script>
<script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-10148377-3');</script>

</head>
<body class="archive tag tag-dremel tag-23 cc-responsive">


<!-- ---------------- Menu --------------------- -->
<div class="container-full-width" id="navigation_menu">
	<div class="container">
		<div class="container-fluid">
			<nav id="navigation" role="navigation">
				<div class="main-navigation navbar">
					<div class="navbar-inner">
						<div class="container">

														<div class="nav-collapse collapse">
								
								<div class="menu-%e4%b8%bb%e8%8f%9c%e5%8d%95-container"><ul id="menu-%e4%b8%bb%e8%8f%9c%e5%8d%95" class="nav">
<li id="menu-item-27229" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-27229"><a href="./../../index.html">首页</a></li>
<li id="menu-item-26815" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-26815"><a href="./../../about/index.html">关于</a></li>
</ul></div>
								
															</div>
						<!-- collapse -->

						<!-- .btn-navbar is used as the toggle for collapsed navbar content -->
							<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
							</a>
												</div>
						<!-- container -->
					</div>
					<!-- .navbar-inner .row-fluid -->
				</div>
				<!-- main-navigation navbar -->
			</nav>
			<!-- #navigation -->
		</div>
		<!-- .container-fluid-->
	</div>
	<!-- .container -->
</div>
<!-- #navigation_menu -->


<!-- --------------- Sub Body -------------------- -->

<div class="container-full-width" id="sub_body">

	<!-- ---------------- Header --------------------- -->
	<div class="container-full-width" id="header_section">
		<div class="container">
						<div class="container-fluid">
					<header id="cc-header" class="row-fluid">
		<div class="span7">
				<div class="hgroup">
		<h2 class="site-title"><a href="./../../index.html" title="我自然" rel="home">我自然</a></h2>
	</div>
		</div>

		<div id="register" class="span5">
				<div id="social">
		<div class="legacy-icons">
					</div>
	</div>

		</div>
	</header>
			</div>
			<!-- .container-fluid-->
		</div>
		<!-- .container -->
	</div>
	<!-- #header_section -->

	<div id="archive_page" class="container-full-width">

		<div class="container">

			<div class="container-fluid">

				
				<div id="container" class="row-fluid">

					
					<div id="content" class=" span9 content-sidebar-right">

						
						
							<header class="page-header">
								<h1 class="page-title">
									标记档案： <span>Dremel</span>								</h1>
															</header>

							
														
								
<article id="post-26452" class="post-26452 post type-post status-publish format-standard hentry category-5 tag-dremel tag-drill tag-google-dremel tag-hadoop">

	<header class="entry-header">

		
		<h2 class="entry-title">
						<a href="./../../google-dremel-rationale/index.html" title="连结到Google Dremel 原理 &#8211; 如何能3秒分析1PB" rel="bookmark">Google Dremel 原理 &#8211; 如何能3秒分析1PB</a>
			
		</h2>
					<div class="entry-meta">
				在 <a href="./../../google-dremel-rationale/index.html" title="下午9:46" rel="bookmark">
							<time class="entry-date updated" datetime="2012-08-23T21:46:45+08:00">2012年8月23日</time>
						</a> 上公布				<span class="byline"> 作者为 <span class="author vcard">
								<a class="url fn n" href="./../../author/yankay/index.html" title="查看 yankay 的所有文章" rel="author">yankay</a>
							</span>
						</span>			</div>
<!-- .entry-meta -->
			</header>
	<!-- .entry-header -->

						<div class="entry-content">
								<h3>简介</h3>
<p>Dremel 是Google 的“交互式”数据分析系统。可以组建成规模上千的集群，处理PB级别的数据。MapReduce处理一个数据，需要分钟级的时间。作为MapReduce的发起人，Google开发了Dremel将处理时间缩短到秒级，作为MapReduce的有力补充。Dremel作为Google BigQuery的report引擎，获得了很大的成功。最近Apache计划推出Dremel的开源实现Drill，将Dremel的技术又推到了浪尖上。</p>
<h3>Google Dremel设计</h3>
<p>根据Google公开的论文《<a href="http://research.google.com/pubs/pub36632.html">Dremel: Interactive Analysis of WebScaleDatasets</a>》可以看到Dremel的设计原理。还有一些测试报告。论文写于2006年，公开于2010年，Google在处理大数据方面，果真有得天独厚的优势。下面的内容，很大部分来自这篇论文。</p>
<p>随着Hadoop的流行，大规模的数据分析系统已经越来越普及。数据分析师需要一个能将数据“玩转”的交互式系统。如此，就可以非常方便快捷的浏览数据，建立分析模型。Dremel系统有下面几个主要的特点：</p>
<ul>
<li>
<strong>Dremel</strong><strong>是一个大规模系统。</strong>在一个PB级别的数据集上面，将任务缩短到秒级，无疑需要大量的并发。磁盘的顺序读速度在100MB/S上下，那么在1S内处理1TB数据，意味着至少需要有1万个磁盘的并发读! Google一向是用廉价机器办大事的好手。但是机器越多，出问题概率越大，如此大的集群规模，需要有足够的容错考虑，保证整个分析的速度不被集群中的个别慢(坏)节点影响。</li>
<li>
<strong>Dremel</strong><strong>是MR</strong><strong>交互式查询能力不足的补充。</strong>和MapReduce一样，Dremel也需要和数据运行在一起，将计算移动到数据上面。所以它需要GFS这样的文件系统作为存储层。在设计之初，Dremel并非是MapReduce的替代品，它只是可以执行非常快的分析，在使用的时候，常常用它来处理MapReduce的结果集或者用来建立分析原型。</li>
<li>
<strong>Dremel</strong><strong>的数据模型是嵌套(nested)</strong><strong>的。</strong>互联网数据常常是非关系型的。Dremel还需要有一个灵活的数据模型，这个数据模型至关重要。Dremel支持一个嵌套(nested)的数据模型，类似于Json。而传统的关系模型，由于不可避免的有大量的Join操作，在处理如此大规模的数据的时候，往往是有心无力的。</li>
<li>
<strong>Dremel</strong><strong>中的数据是用列式存储的。</strong>使用列式存储，分析的时候，可以只扫描需要的那部分数据的时候，减少CPU和磁盘的访问量。同时列式存储是压缩友好的，使用压缩，可以综合CPU和磁盘，发挥最大的效能。对于关系型数据，如果使用列式存储，我们都很有经验。但是对于嵌套(nested)的结构，Dremel也可以用列存储，非常值得我们学习。</li>
<li>
<strong>Dremel</strong><strong>结合了Web</strong><strong>搜索 </strong><strong>和并行DBMS</strong><strong>的技术。</strong>首先，他借鉴了Web搜索中的“查询树”的概念，将一个相对巨大复杂的查询，分割成较小较简单的查询。大事化小，小事化了，能并发的在大量节点上跑。其次，和并行DBMS类似，Dremel可以提供了一个SQL-like的接口，就像Hive和Pig那样。</li>
</ul>
<h4>Google Dremel应用场景</h4>
<p>设想一个使用场景。我们的美女数据分析师，她有一个新的想法要验证。要验证她的想法，需要在一个上亿条数据上面，跑一个查询，看看结果和她的想法是不是一样，她可不希望等太长时间，最好几秒钟结果就出来。当然她的想法不一定完善，还需要不断调整语句。然后她验证了想法，发现了数据中的价值。最后，她可以将这个语句完善成一个长期运行的任务。</p>
<p>对于Google,数据一开始是放在GFS上的。可以通过MapReduce将数据导入到Dremel中去，在这些MapReduce中还可以做一些处理。然后分析师使用Dremel，轻松愉悦的分析数据，建立模型。最后可以编制成一个长期运行的MapReduce任务。</p>
<p>这种处理方式，让笔者联想到Greenplum的<a href="http://www.greenplum.com/products/chorus">Chorus</a>. Chorus也可以为分析师提供快速的数据查询，不过解决方案是通过预处理，导入部分数据，减少数据集的大小。用的是三十六计，走为上计，避开的瞬时分析大数据的难题。Chorus最近即将开源，可以关注下。</p>
<p>还有一点特别的就是按列存储的嵌套数据格式。如图所示，在按记录存储的模式中，一个记录的多列是连续的写在一起的。在按列存储中，可以将数据按列分开。也就是说，可以仅仅扫描A.B.C而不去读A.E或者A.B.C。难点在于，我们如何能同时高效地扫描若干列，并做一些分析。</p>
<p><img decoding="async" class="alignnone size-medium wp-image-27246" src="http://47.100.65.109/wp-content/uploads/2012/08/2012111251-300x148.jpeg" alt="" width="300" height="148" srcset="./../../wp-content/uploads/2012/08/2012111251-300x148.jpeg 300w, ./../../wp-content/uploads/2012/08/2012111251.jpeg 500w" sizes="(max-width: 300px) 100vw, 300px"></p>
<h4>Google Dremel数据模型</h4>
<p>在Google, 用Protocol Buffer常常作为序列化的方案。其数据模型可以用数学方法严格的表示如下：</p>
<p>$$!t=dom |&lt;a_1:t[*|?],&#8230;,a_n:t[*|?]&gt;$$&lt;/a_1:t[*|?],&#8230;,a_n:t[*|?]&gt;</p>
<p>其中t可以是一个基本类型或者组合类型。其中基本类型可以是integer,float和string。组合类型可以是若干个基本类型拼凑。星号(*)指的是任何类型都可以重复，就是数组一样。问号(?)指的是任意类型都是可以是可选的。简单来说，除了没有Map外，和一个Json几乎没有区别。</p>
<p>下图是例子，Schema定义了一个组合类型Document.有一个必选列DocId，可选列Links，还有一个数组列Name。可以用Name.Language.Code来表示Code列。</p>
<p><img fetchpriority="high" decoding="async" class="alignnone size-medium wp-image-27247" src="http://47.100.65.109/wp-content/uploads/2012/08/2012111252-300x214.jpeg" alt="" width="300" height="214" srcset="./../../wp-content/uploads/2012/08/2012111252-300x214.jpeg 300w, ./../../wp-content/uploads/2012/08/2012111252.jpeg 500w" sizes="(max-width: 300px) 100vw, 300px"></p>
<p>这种数据格式是语言无关，平台无关的。可以使用Java来写MR程序来生成这个格式，然后用C++来读取。在这种列式存储中，能够快速通用处理也是非常的重要的。</p>
<p>上图，是一个示例数据的抽象的模型；下图是这份数据在Dremel实际的存储的格式。</p>
<p><img decoding="async" class="alignnone size-medium wp-image-27249" src="http://47.100.65.109/wp-content/uploads/2012/08/2012111253-300x201.jpeg" alt="" width="300" height="201" srcset="./../../wp-content/uploads/2012/08/2012111253-300x201.jpeg 300w, ./../../wp-content/uploads/2012/08/2012111253.jpeg 500w" sizes="(max-width: 300px) 100vw, 300px"></p>
<p>如果是关系型数据，而不是嵌套的结构。存储的时候，我们可以将每一列的值直接排列下来，不用引入其他的概念，也不会丢失数据。对于嵌套的结构，我们还需要两个变量R (Repetition Level) ,D (Definition Level) 才能存储其完整的信息。</p>
<p><strong>Repetition Level</strong>是记录该列的值是在哪一个级别上重复的。举个例子说明：对于Name.Language.Code? 我们一共有三条非Null的记录。</p>
<ol>
<li>第一个是”en-us”，出现在第一个Name的第一个Lanuage的第一个Code里面。在此之前，这三个元素是没有重复过的，都是第一个。所以其R为0。</li>
<li>第二个是”en”，出现在下一个Lanuage里面。也就是说Lanague是重复的元素。Name.Language.Code中Lanague排第二个，所以其R为2.</li>
<li>第三个是”en-gb”，出现在下一个Name中，Name是重复元素，排第一个，所以其R为1。</li>
</ol>
<p>我们可以想象，将所有的没有值的列，设值为NULL。如果是数组列，我们也想象有一个NULL值。有了Repetition Level，我们就可以很好的用列表示嵌套的结构了。但是还有一点不足。就是还需要表示一个数组是不是我们想象出来的。</p>
<p><strong>Definition Level</strong> 是定义的深度，用来记录该列是否是”想象”出来的。所以对于非NULL的记录，是没有意义的，其值必然为相同。同样举个例子。例如Name.Language.Country,</p>
<ul>
<li>第一个”us”是在R1里面，其中Name,Language,Country是有定义的。所以D为3。</li>
<li>第二个”NULL”也是在R1的里面，其中Name,Language是有定义的,其他是想象的。所以D为2。</li>
<li>第三个”NULL”还是在R1的里面，其中Name是有定义的,其他是想象的。所以D为1。</li>
<li>第四个”gb”是在R1里面，其中Name,Language,Country是有定义的。所以D为3。</li>
</ul>
<p>就是这样，如果路径中有required，可以将其减去，因为required必然会define，记录其数量没有意义。</p>
<p>理解了如何存储这种嵌套结构。写没有难度。读的时候，我们只读其中部分字段，来构建部分的数据模型。例如，只读取DocID和Name.Language.Country。我们可以同时扫描两个字段，先扫描DocID。记录下第一个，然后发现下一个DocID的R是0；于是该读Name.Language.Country，如果下一个R是1或者2就继续读，如果是0就开始读下一个DocID。</p>
<p><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-27250" src="http://47.100.65.109/wp-content/uploads/2012/08/2012111254-300x133.jpeg" alt="" width="300" height="133" srcset="./../../wp-content/uploads/2012/08/2012111254-300x133.jpeg 300w, ./../../wp-content/uploads/2012/08/2012111254.jpeg 500w" sizes="(max-width: 300px) 100vw, 300px"></p>
<p>下图展示了一个更为复杂的读取的状态机示例。在读取过程中使用了Definition Level来快速Jump,提升性能。</p>
<p><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-27251" src="http://47.100.65.109/wp-content/uploads/2012/08/2012111255-300x180.jpeg" alt="" width="300" height="180" srcset="./../../wp-content/uploads/2012/08/2012111255-300x180.jpeg 300w, ./../../wp-content/uploads/2012/08/2012111255.jpeg 500w" sizes="(max-width: 300px) 100vw, 300px"></p>
<p>到此为止，我们已经知道了Dremel的数据结构。就像其他数据分析系统一样，数据结构确定下来，功能就决定了一大半。对于Dremel的数据查询，必然是“全表扫描”，但由于其巧妙的列存储设计，良好的数据模型设计可以回避掉大部分Join需求和扫描最少的列。</p>
<h4>Google Dremel查询方式</h4>
<p>Dremel可以使用一种SQL-like的语法查询嵌套数据。由于Dremel的数据是只读的，并且会密集的发起多次类似的请求。所以可以保留上次请求的信息，还优化下次请求的explain过程。那又是如何explain的呢？</p>
<p><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-27252" src="http://47.100.65.109/wp-content/uploads/2012/08/2012111256-300x191.jpeg" alt="" width="300" height="191" srcset="./../../wp-content/uploads/2012/08/2012111256-300x191.jpeg 300w, ./../../wp-content/uploads/2012/08/2012111256.jpeg 500w" sizes="(max-width: 300px) 100vw, 300px"></p>
<p>这是一个树状架构。当Client发其一个请求，根节点受到请求，根据metadata，将其分解到枝叶，直到到位于数据上面的叶子Server。他们扫描处理数据，又不断汇总到根节点。</p>
<p>举个例子：对于请求：</p>
<pre>SELECT A, COUNT(B) FROM T GROUP BY A</pre>
<p>根节点收到请求，会根据数据的分区请求，将请求变成可以拆分的样子。原来的请求会变为。</p>
<pre>SELECT A, SUM(c) FROM (R1 UNION ALL ... Rn) GROUP BY A</pre>
<p>R1,…RN是T的分区计算出的结果集。越大的表有越多的分区，越多的分区可以越好的支持并发。</p>
<p>然后再将请求切分，发送到每个分区的叶子Server上面去,对于每个Server</p>
<pre>?Ri = SELECT A, COUNT(B) AS c FROM Ti GROUP BY A</pre>
<p>结构集一定会比原始数据小很多，处理起来也更快。根服务器可以很快的将数据汇总。具体的聚合方式，可以使用现有的并行数据库技术。</p>
<p>Dremel是一个多用户的系统。切割分配任务的时候，还需要考虑用户优先级和负载均衡。对于大型系统，还需要考虑容错，如果一个叶子Server出现故障或变慢，不能让整个查询也受到明显影响。</p>
<p>通常情况下，每个计算节点，执行多个任务。例如，技巧中有3000个叶子Server，每个Server使用8个线程，有可以有24000个计算单元。如果一张表可以划分为100000个区，就意味着大约每个计算单元需要计算5个区。这执行的过程中，如果某一个计算单元太忙，就会另外启一个来计算。这个过程是动态分配的。</p>
<p>对于GFS这样的存储，一份数据一般有3份拷贝，计算单元很容易就能分配到数据所在的节点上，典型的情况可以到达95%的命中率。</p>
<p>Dremel还有一个配置，就是在执行查询的时候，可以指定扫描部分分区，比如可以扫描30%的分区，在使用的时候，相当于随机抽样，加快查询。</p>
<h3>Google Dremel测试实验</h3>
<p>实验的数据源如下表示。大部分数据复制了3次，也有一个两次。每个表会有若干分区，每个分区的大小在100K到800K之间。如果压缩率是25%，并且计入复制3份的事实的话。T1的大小已经达到PB级别。这么小且巨量的分区，对于GFS的要求很高，现在的Hdfs稳定版恐怕受不了。接下来的测试会逐步揭示其是如何超过MR，并对性能作出分析。</p>
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="106"><strong>表名</strong></td>
<td valign="top" width="106"><strong>记录数</strong></td>
<td valign="top" width="106">
<strong>大小(</strong><strong>已压缩)</strong>
</td>
<td valign="top" width="106"><strong>列数</strong></td>
<td valign="top" width="106"><strong>数据中心</strong></td>
<td valign="top" width="106"><strong>复制数量</strong></td>
</tr>
<tr>
<td valign="top" width="106">T1</td>
<td valign="top" width="106">85 billion</td>
<td valign="top" width="106">87 TB</td>
<td valign="top" width="106">270</td>
<td valign="top" width="106">A</td>
<td valign="top" width="106">3×</td>
</tr>
<tr>
<td valign="top" width="106">T2</td>
<td valign="top" width="106">24 billion</td>
<td valign="top" width="106">13 TB</td>
<td valign="top" width="106">530</td>
<td valign="top" width="106">A</td>
<td valign="top" width="106">3×</td>
</tr>
<tr>
<td valign="top" width="106">T3</td>
<td valign="top" width="106">4 billion</td>
<td valign="top" width="106">70 TB</td>
<td valign="top" width="106">1200</td>
<td valign="top" width="106">A</td>
<td valign="top" width="106">3×</td>
</tr>
<tr>
<td valign="top" width="106">T4</td>
<td valign="top" width="106">1+ trillion</td>
<td valign="top" width="106">105 TB</td>
<td valign="top" width="106">50</td>
<td valign="top" width="106">B</td>
<td valign="top" width="106">2×</td>
</tr>
<tr>
<td valign="top" width="106">T5</td>
<td valign="top" width="106">1+ trillion</td>
<td valign="top" width="106">20 TB</td>
<td valign="top" width="106">30</td>
<td valign="top" width="106">B</td>
<td valign="top" width="106">3×</td>
</tr>
</tbody>
</table>
<h4>列存测试</h4>
<p>首先，我们测试看看列存的效果。对于T1表，1GB的数据大约有300K行，使用列存的话压缩后大约在375MB。这台机器磁盘的吞吐在70MB/s左右。这1GB的数据，就是我们的现在的测试数据源，测试环境是单机。</p>
<p><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-27253" src="http://47.100.65.109/wp-content/uploads/2012/08/2012111257-300x194.jpeg" alt="" width="300" height="194" srcset="./../../wp-content/uploads/2012/08/2012111257-300x194.jpeg 300w, ./../../wp-content/uploads/2012/08/2012111257.jpeg 500w" sizes="(max-width: 300px) 100vw, 300px"></p>
<p>见上图。</p>
<ul>
<li>曲线A，是用列存读取数据并解压的耗时。</li>
<li>曲线B是一条一条记录挨个读的时间。</li>
<li>曲线C是在B的基础上，加上了反序列化的时间。</li>
<li>曲线d，是按行存读并解压的耗时。</li>
<li>曲线e加上了反序列化的时间。因为列很多，反序列化耗时超过了读并解压的50%。</li>
</ul>
<p>从图上可以看出。如果需要读的列很少的话，列存的优势就会特别的明显。对于列的增加，产生的耗时也几乎是线性的。而一条一条该个读和反序列化的开销是很大的，几乎都在原来基础上增加了一倍。而按行读，列数的增加没有影响，因为一次性读了全部列。</p>
<h4>Dremel和MapReduce的对比测试</h4>
<p>MR和Dremel最大的区别在于行存和列存。如果不能击败MapReduce，Remel就没有意义了。使用最常见的WordCount测试，计算这个数据中Word的个数。</p>
<pre>Q1: SELECT SUM(CountWords(txtField)) / COUNT(*) FROM T1</pre>
<p><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-27254" src="http://47.100.65.109/wp-content/uploads/2012/08/2012111258-300x136.jpeg" alt="" width="300" height="136" srcset="./../../wp-content/uploads/2012/08/2012111258-300x136.jpeg 300w, ./../../wp-content/uploads/2012/08/2012111258.jpeg 500w" sizes="(max-width: 300px) 100vw, 300px"></p>
<p>上图是测试的结果。使用了两个MR任务。这两个任务和Dremel一样都运行在3000个节点上面。如果使用列存，Dremel的按列读的MR只需要读0.5TB的数据，而按行存需要读87TB。 MR提供了一个方便有效的途经来讲按行数据转换成按列的数据。Dremel可以方便的导入MapReduce的处理结果。</p>
<h4>树状计算Server测试</h4>
<p>接下来我们要对比在T2表示使用两个不同的Group BY查询。T2表有24 billion 行的记录。每个记录有一个 item列表，每一item有一个amount 字段。总共有40 billion个item.amount。这两个Query分别是。</p>
<pre>Q2: SELECT country, SUM(item.amount) FROM T2 GROUP BY country

Q3: SELECT domain, SUM(item.amount) FROM T2 WHERE domain CONTAINS ’.net’ GROUP BY domain</pre>
<p>Q2需要扫描60GB的压缩数据，Q3需要扫描180GB，同时还要过滤一个条件。</p>
<p><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-27257" src="http://47.100.65.109/wp-content/uploads/2012/08/2012111259-300x131.jpeg" alt="" width="300" height="131" srcset="./../../wp-content/uploads/2012/08/2012111259-300x131.jpeg 300w, ./../../wp-content/uploads/2012/08/2012111259.jpeg 500w" sizes="(max-width: 300px) 100vw, 300px"></p>
<p>上图是这两个Query在不同的server拓扑下的性能。每个测试都是有2900个叶子Server。在2级拓扑中，根server直接和叶子Server通信。在3级拓扑中，各个级别的比例是1:100:2900，增加了100个中间Server。在4级拓扑中，比例为1:10:100:2900.</p>
<p>Q2可以在3级拓扑下3秒内执行完毕，但是为他提供更高的拓扑级别，对性能提升没有裨益。相比之下，为Q3提供更高的拓扑级别，性能可以有效提升。这个测试体现了树状拓扑对性能提升的作用。</p>
<h4>每个分区的执行情况</h4>
<p>对于刚刚的两个查询，具体的每个分区的执行情况是这样的。</p>
<p><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-27258" src="http://47.100.65.109/wp-content/uploads/2012/08/20121112510-300x143.jpeg" alt="" width="300" height="143" srcset="./../../wp-content/uploads/2012/08/20121112510-300x143.jpeg 300w, ./../../wp-content/uploads/2012/08/20121112510.jpeg 500w" sizes="(max-width: 300px) 100vw, 300px"></p>
<p>可以看到99%的分区都在1s内完成了。Dremel会自动调度，使用新的Server计算拖后腿的任务。</p>
<h4>记录内聚合</h4>
<p>由于Demel支持List的数据类型，有的时候，我们需要计算每个记录里面的各个List的聚合。如</p>
<pre>Q4 : SELECT COUNT(c1 &gt; c2) FROM

(SELECT SUM(a.b.c.d) WITHIN RECORD AS c1,

SUM(a.b.p.q.r) WITHIN RECORD AS c2

FROM T3)</pre>
<p>我们需要count所有sum(a.b.c.d)比sum(a.b.p.q.r)，执行这条语句实际只需要扫描13GB的数据，耗时15s，而整张表有70TB。如果没有这样的嵌套数据结构，这样的查询会很复杂。</p>
<h4>扩展性测试</h4>
<p>Dremel有良好的扩展性，可以通过增加机器来缩短查询的时间。并且可以处理数以万亿计的记录。</p>
<p>对于查询：</p>
<pre>Q5: SELECT TOP(aid, 20), COUNT(*) FROM T4?WHERE bid = fvalue1g AND cid = fvalue2g</pre>
<p>使用不同的叶子Server数目来进行测试。</p>
<p><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-27260" src="http://47.100.65.109/wp-content/uploads/2012/08/20121112511-300x124.jpeg" alt="" width="300" height="124" srcset="./../../wp-content/uploads/2012/08/20121112511-300x124.jpeg 300w, ./../../wp-content/uploads/2012/08/20121112511.jpeg 500w" sizes="(max-width: 300px) 100vw, 300px"></p>
<p>可以发现CPU的耗时总数是基本不变的，在30万秒左右。但是随着节点数的增加，执行时间也会相应缩短。几乎呈线性递减。如果我们使用通过CPU时间计费的“云计算”机器，每个租户的查询都可以很快，成本也会非常低廉。</p>
<h3>容错测试</h3>
<p>一个大团队里面，总有几个拖油瓶。对于有万亿条记录的T5，我们执行下面的语句。</p>
<pre>Q6: SELECT COUNT(DISTINCT a) FROM T5</pre>
<p>值得注意的是T5的数据只有两份拷贝，所以有更高的概率出现坏节点和拖油瓶。这个查询需要扫描大约1TB的压缩数据，使用2500个节点。</p>
<p><img loading="lazy" decoding="async" class="alignnone size-medium wp-image-27261" src="http://47.100.65.109/wp-content/uploads/2012/08/20121112512-300x155.jpeg" alt="" width="300" height="155" srcset="./../../wp-content/uploads/2012/08/20121112512-300x155.jpeg 300w, ./../../wp-content/uploads/2012/08/20121112512.jpeg 500w" sizes="(max-width: 300px) 100vw, 300px"></p>
<p>可以看到99%的分区都在5S内完成的。不幸的是，有一些分区需要较长的时间来处理。尽管通过动态调度可以加快一些，但在如此大规模的计算上面，很难完全不出问题。如果不在意太精确的结果，完全可以小小减少覆盖的比例，大大提升相应速度。</p>
<h3>Google Dremel 的影响</h3>
<p>Google Dremel的能在如此短的时间内处理这么大的数据，的确是十分惊艳的。有个伯克利分校的教授Armando Fox说过一句话“如果你曾事先告诉我Dremel声称其将可做些什么，那么我不会相信你能开发出这种工具”。这么给力的技术，必然对业界造成巨大的影响。第一个被波及到的必然是Hadoop。</p>
<h4>Dremel与Hadoop</h4>
<p>Dremel的公开论文里面已经说的很明白，Dremel不是用来替代MapReduce，而是和其更好的结合。Hadoop的Hive，Pig无法提供及时的查询，而Dremel的快速查询技术可以给Hadoop提供有力的补充。同时Dremel可以用来分析MapReduce的结果集，只需要将MapReduce的OutputFormat修改为Dremel的格式，就可以几乎不引入额外开销，将数据导入Dremel。使用Dremel来开发数据分析模型，MapReduce来执行数据分析模型。</p>
<p>Hadoop的Hive,Pig现在也有了列存的模式，架构上和Dremel也接近。但是无论存储结构还是计算方式都没有Dremel精致。对Hadoop实时性的改进也一直是个热点话题。要想在Hadoop中山寨一个Dremel，并且相对现有解决方案有突破，笔者觉得Hadoop自身需要一些改进。一个是HDFS需要对并发细碎的数据读性能有大的改进，HDFS需要更加的低延迟。再者是Hadoop需要不仅仅支持MapReduce这一种计算框架。其他部分,Hadoop都有对应的开源组件，万事俱备只欠东风。</p>
<h4>Dremel的开源实现</h4>
<p>Dremel现在还没有一个可以运行的开源实现，不过我们看到很多努力。一个是Apache的Drill，一个是OpenDremel/Dazo。</p>
<p><strong>OpenDremel/Dazo</strong></p>
<p>OpenDremel是一个开源项目，最近改名为Dazo。可以在GoogleCode上找到<a href="http://code.google.com/p/dremel/">http://code.google.com/p/dremel/</a>。目前还没有发布。作者声称他已经完成了一个通用执行引擎和OpenStack Swift的集成。笔者感觉其越走越歪，离Dremel越来越远了。</p>
<p><strong>Apache Drill</strong></p>
<p><a href="http://wiki.apache.org/incubator/DrillProposal">Drill </a>是Hadoop的赞助商之一MapR发起的。Drill作为一个Dremel的山寨项目，有和Dremel相似的架构和能力。他们希望Drill最终会想Hive,Pig一样成为Hadoop上的重要组成部分。为Hadoop提供快速查询的能力。和Dremel有一点不同，在数据模型上，开源的项目需要支持更标准的数据结构。比如CSV和JSON。同时Drill还有更大的灵活性，支持多重查询语言，多种接口。</p>
<p>现在Drill的目标是完成初始的需求，架构。完成一个初始的实现。这个实现包括一个执行引擎和DrQL。DrQL是一个基于列的格式，类似于Dremel。目前，Drill已经完成的需求和架构设计。总共分为了四个组件</p>
<ul>
<li>Query language:类似Google BigQuery的查询语言，支持嵌套模型，名为DrQL.</li>
<li>Low-lantency distribute execution engine:执行引擎，可以支持大规模扩展和容错。可以运行在上万台机器上计算数以PB的数据。</li>
<li>Nested data format:嵌套数据模型，和Dremel类似。也支持CSV,JSON,YAML类似的模型。这样执行引擎就可以支持更多的数据类型。</li>
<li>Scalable data source: 支持多种数据源，现阶段以Hadoop为数据源。</li>
</ul>
<p>目前这四个组件在分别积极的推进，Drill也非常希望有社区其他公司来加入。Drill希望加入到Hadoop生态系统中去。</p>
<h3>最后的话</h3>
<p>本文介绍了Google Dremel的使用场景，设计实现，测试实验，和对开源世界的影响。相信不久的将来，Dremel的技术会得到广泛的应用。</p>
							</div>
<!-- .entry-content -->
		
	
	<footer class="entry-meta">
		
							<span class="cat-links">
				文章分类 <a href="./../../category/%e6%8a%80%e6%9c%af/index.html" rel="category tag">软件技术</a>			</span>
				<span class="sep"> | </span>
			
							<span class="taglinks">
				标签： <a href="./index.html" rel="tag">Dremel</a>, <a href="./../drill/index.html" rel="tag">Drill</a>, <a href="./../google-dremel/index.html" rel="tag">Google Dremel</a>, <a href="./../hadoop/index.html" rel="tag">Hadoop</a>			</span>
				<span class="sep"> | </span>
			
		
						<span class="comments-link"><a href="./../../google-dremel-rationale/index.html#comments">15 评论</a></span>
				<span class="sep"> | </span>
			
		
	</footer>
	<!-- #entry-meta -->

</article><!-- #post-26452 -->

							
						
						
					</div>
					<!-- #content -->

					
<div id="secondary" class="widget-area span3">

	
	<div id="sidebar">
		<aside id="search-2" class="widget-container widget_search"><form method="get" id="searchform" class="navbar-search pull-right" action="http://yankay.com/" role="search">
	<input type="text" class="search-query input-medium" name="s" placeholder="Search &hellip;">
</form>
<div class="clear"></div>
</aside>
		<aside id="recent-posts-2" class="widget-container widget_recent_entries">
		<h3 class="widget-title">近期文章</h3>
		<ul>
											<li>
					<a href="./../../containerd-will-replace-docker/index.html">听说 Docker 被 kubenetes 抛弃了，怎么办？containerd</a>
									</li>
											<li>
					<a href="./../../%e5%85%ac%e5%91%8a-%e5%8d%9a%e5%ae%a2%e9%87%8d%e5%bc%80%e4%ba%86/index.html">公告 &#8211; 博客重开了</a>
									</li>
											<li>
					<a href="./../../cloudfoundry-v2-with-microcf/index.html">CloudFoundry v2面面谈，内赠MicroCFv2福利</a>
									</li>
											<li>
					<a href="./../../docker-paas-for-any-application/index.html">Docker能够运行任何应用的“PaaS”云</a>
									</li>
											<li>
					<a href="./../../scala-tour-choiceness/index.html">Scala Tour &#8211; 精选</a>
									</li>
					</ul>

		</aside><aside id="recent-comments-2" class="widget-container widget_recent_comments"><h3 class="widget-title">近期评论</h3>
<ul id="recentcomments">
<li class="recentcomments">
<span class="comment-author-link"><a href="https://www.ccppcoding.com/archives/63098.html" class="url" rel="ugc external nofollow">[整理]完美哈希函数(Perfect Hash Function) - 高性能架构探索</a></span>发表在《<a href="./../../introduction-to-opmphf/index.html#comment-3101">最小完美哈希函数简介</a>》</li>
<li class="recentcomments">
<span class="comment-author-link"><a href="https://www.javatt.com/p/284115" class="url" rel="ugc external nofollow">Scala Tour – 精选 - Java天堂</a></span>发表在《<a href="./../../scala-tour-choiceness/index.html#comment-2781">Scala Tour &#8211; 精选</a>》</li>
<li class="recentcomments">
<span class="comment-author-link"><a href="https://www.zhankr.net/46292.html" class="url" rel="ugc external nofollow">Golang适合高并发场景的原因分析 - 站壳网</a></span>发表在《<a href="./../../go-clear-concurreny/index.html#comment-2701">Go-简洁的并发</a>》</li>
<li class="recentcomments">
<span class="comment-author-link"><a href="https://code84.com/710435.html" class="url" rel="ugc external nofollow">HBase 官方文档 &#8211; 源码巴士</a></span>发表在《<a href="./../../windows%e4%b8%8beclipse%e7%9a%84-c%e7%8e%af%e5%a2%83%e9%85%8d%e7%bd%ae/index.html#comment-2679">Windows下eclipse的 C++环境配置</a>》</li>
<li class="recentcomments">
<span class="comment-author-link"><a href="https://www.ideaopen.cn/98230.html" class="url" rel="ugc external nofollow">Go-简洁的并发-点开</a></span>发表在《<a href="./../../go-clear-concurreny/index.html#comment-1255">Go-简洁的并发</a>》</li>
</ul></aside><aside id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">归档</h3>
			<ul>
					<li><a href="./../../2021/06/index.html">2021年6月</a></li>
	<li><a href="./../../2021/03/index.html">2021年3月</a></li>
	<li><a href="./../../2014/02/index.html">2014年2月</a></li>
	<li><a href="./../../2013/09/index.html">2013年9月</a></li>
	<li><a href="./../../2013/05/index.html">2013年5月</a></li>
	<li><a href="./../../2013/01/index.html">2013年1月</a></li>
	<li><a href="./../../2012/11/index.html">2012年11月</a></li>
	<li><a href="./../../2012/09/index.html">2012年9月</a></li>
	<li><a href="./../../2012/08/index.html">2012年8月</a></li>
	<li><a href="./../../2012/03/index.html">2012年3月</a></li>
	<li><a href="./../../2012/02/index.html">2012年2月</a></li>
	<li><a href="./../../2012/01/index.html">2012年1月</a></li>
	<li><a href="./../../2011/11/index.html">2011年11月</a></li>
	<li><a href="./../../2011/10/index.html">2011年10月</a></li>
	<li><a href="./../../2011/09/index.html">2011年9月</a></li>
	<li><a href="./../../2010/10/index.html">2010年10月</a></li>
	<li><a href="./../../2010/08/index.html">2010年8月</a></li>
	<li><a href="./../../2010/07/index.html">2010年7月</a></li>
	<li><a href="./../../2010/06/index.html">2010年6月</a></li>
	<li><a href="./../../2010/05/index.html">2010年5月</a></li>
	<li><a href="./../../2010/04/index.html">2010年4月</a></li>
	<li><a href="./../../2010/03/index.html">2010年3月</a></li>
	<li><a href="./../../2010/02/index.html">2010年2月</a></li>
	<li><a href="./../../2010/01/index.html">2010年1月</a></li>
	<li><a href="./../../2009/10/index.html">2009年10月</a></li>
	<li><a href="./../../2009/09/index.html">2009年9月</a></li>
	<li><a href="./../../2009/08/index.html">2009年8月</a></li>
	<li><a href="./../../2009/07/index.html">2009年7月</a></li>
	<li><a href="./../../2009/06/index.html">2009年6月</a></li>
	<li><a href="./../../2008/10/index.html">2008年10月</a></li>
	<li><a href="./../../2008/08/index.html">2008年8月</a></li>
	<li><a href="./../../2008/07/index.html">2008年7月</a></li>
	<li><a href="./../../2008/06/index.html">2008年6月</a></li>
			</ul>

			</aside><aside id="categories-2" class="widget-container widget_categories"><h3 class="widget-title">分类目录</h3>
			<ul>
					<li class="cat-item cat-item-3">
<a href="./../../category/%e5%ae%b6%e5%ba%ad%e7%94%9f%e6%b4%bb/index.html">家庭生活</a>
</li>
	<li class="cat-item cat-item-1">
<a href="./../../category/uncategorized/index.html">未分类</a>
</li>
	<li class="cat-item cat-item-7">
<a href="./../../category/%e6%8a%80%e6%9c%af/%e6%af%8f%e6%97%a5%e5%bf%83%e5%be%97/index.html">每日心得</a>
</li>
	<li class="cat-item cat-item-5">
<a href="./../../category/%e6%8a%80%e6%9c%af/index.html">软件技术</a>
</li>
			</ul>

			</aside><aside id="nav_menu-3" class="widget-container widget_nav_menu"><h3 class="widget-title">友情链接</h3>
<div class="menu-%e5%8f%8b%e6%83%85%e9%93%be%e6%8e%a5-container"><ul id="menu-%e5%8f%8b%e6%83%85%e9%93%be%e6%8e%a5" class="menu">
<li id="menu-item-27287" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-27287"><a href="https://www.daocloud.io/dce">DaoCloud Enterprise</a></li>
<li id="menu-item-27288" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-27288"><a href="https://www.daocloud.io/dch">DaoCloud 云原生一体机</a></li>
</ul></div></aside>	</div>
	<!-- #sidebar -->

	
</div>
<!-- #secondary .widget-area .span3 -->
				</div>
				<!-- #container .row-fluid-->

				
			</div>
			<!--container fluid -->

		</div>
		<!-- container -->

	</div>
<!-- container full width -->



	<div class="container-full-width" id="after_footer">
		<div class="container">
			<div class="container-fluid">
				<footer class="site-footer row-fluid">
					<div class="span6">
						<div id="credit">
															<a href="http://cyberchimps.com/" target="_blank" title="CyberChimps Themes">
																			<h4 class="cc-credit-text">CyberChimps WordPress Themes</h4></a>
																	
													
						</div>
					</div>
					<!-- Adds the afterfooter copyright area -->
					<div class="span6">
												<div id="copyright">
							沪ICP备2021008917号-1 © 颜开						</div>
					</div>
				</footer>
				<!-- row-fluid -->
			</div>
			<!-- .container-fluid-->
		</div>
		<!-- .container -->
	</div>    <!-- #after_footer -->


</div>
<!-- End Sub Body -->


		<script type="text/javascript">jQuery(document).ready(function($){
			$(window).scroll(function()  {
			if ($(this).scrollTop() > 0) {
			$('#header_section').addClass("sticky-header");
                       
			}
			else{
			$('#header_section').removeClass("sticky-header");
                       
			}
			});
		});</script>
	<script type="text/javascript" src="./../../wp-content/themes/neuro/inc/js/jquery.flexslider.js?ver=1.0" id="jquery-flexslider-js"></script>
<script type="text/javascript" src="./../../wp-content/themes/neuro/cyberchimps/lib/bootstrap/js/bootstrap.min.js?ver=2.0.4" id="bootstrap-js-js"></script>
<script type="text/javascript" src="./../../wp-content/themes/neuro/cyberchimps/lib/js/retina-1.1.0.min.js?ver=1.1.0" id="retina-js-js"></script>

</body>
</html>